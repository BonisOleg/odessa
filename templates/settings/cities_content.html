{% load static %}

<!-- Тільки контент для HTMX (без layout) -->
<div class="page-header">
    <h1>Управление городами</h1>
    <p><a href="/settings/" hx-get="/settings/" hx-target="#main-content" hx-push-url="true" class="text-primary">←
            Назад к настройкам</a></p>
</div>

<div class="card">
    <div class="card__header">
        <div class="card__header-flex">
            <h3 class="card__title">Список городов</h3>
            <button type="button" class="button button--primary" hx-get="/settings/cities/add/" hx-target="body"
                hx-swap="beforeend">+ Добавить город</button>
        </div>
    </div>

    <!-- Фільтр по країні -->
    <div class="mb-lg">
        <select class="form-select form-select--max-width" hx-get="{% url 'myapp:settings_cities' %}" hx-target="#main-content" hx-trigger="change" name="country">
            <option value="">Все страны</option>
            {% for country in countries %}
            <option value="{{ country.pk }}" {% if selected_country == country.pk|stringformat:"s" %}selected{% endif %}>{{ country.name }}</option>
            {% endfor %}
        </select>
    </div>

    <table class="table">
        <thead class="table__head">
            <tr>
                <th class="table__th">Название</th>
                <th class="table__th">Страна</th>
                <th class="table__th">Кол-во компаний</th>
                <th class="table__th">Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for city in cities %}
            <tr class="table__row">
                <td class="table__td">{{ city.name }}</td>
                <td class="table__td">{{ city.country.flag_emoji }} {{ city.country.name }}</td>
                <td class="table__td">{{ city.companies_count }}</td>
                <td class="table__td">
                    <button type="button" class="button button--sm button--secondary" hx-get="{% url 'myapp:settings_city_edit' city.pk %}" hx-target="body" hx-swap="beforeend">Редактировать</button>
                    <button type="button" class="button button--sm button--danger" hx-get="{% url 'myapp:settings_city_delete' city.pk %}" hx-target="body" hx-swap="beforeend">Удалить</button>
                </td>
            </tr>
            {% empty %}
            <tr class="table__row">
                <td class="table__td" colspan="4">Нет данных</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>